<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <link href="https://punkt-cdn.oslo.kommune.no/latest/css/pkt.min.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Origo bordtennis-ranking</title>
    <style></style>
    <script>
        const setLiProps = (li, item) => {
            li.className = item.rowClass;
            li.innerHTML = item.displayName + ' (' + item.poeng + ' poeng)';
            li.dataset.poeng = item.poeng;
            li.value = item.posisjon;
        };

        function onSuccess(updatedData) {
            const list = document.getElementById('rankingList');
            updatedData.slice(0, list.childElementCount).forEach((item, idx) => {
                const existingLi = list.children[idx];
                setLiProps(existingLi, item);
            });

            updatedData.slice(list.childElementCount).forEach(item => {
                const li = document.createElement('li');
                setLiProps(li, item);
                list.appendChild(li);
            });
            while (list.childElementCount > updatedData.length) {
                list.removeChild(list.lastElementChild);
            }
        }
        setInterval(()=>{
            google.script.run.withSuccessHandler(onSuccess).getDataForWebDisplay()
        },1e4)

    </script>
</head>
<body>
<section class="pkt-grid pkt-grid--center">
    <div class="pkt-cell pkt-cell--span12 pkt-cell--center">
        <img src="https://i.imgur.com/KTyxrMD.png" alt="St Hallvard spiller bordtennis" />
        <h1 class="pkt-txt-40">Origo bordtennis-ranking</h1>
    </div>
    <div class="pkt-cell pkt-cell--span12 pkt-cell--center">
        <ol id="rankingList">
        <? for (var i = 0; i < data.length; i++) { ?>
                <li class="<?=data[i].rowClass?>">
                    <?=data[i].displayName?> (<?=data[i].poeng?> poeng)
                </li>
        <? } ?>
        </ol>
    </div>
</section>
</body>
</html>
